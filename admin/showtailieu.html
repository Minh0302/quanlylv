<!DOCTYPE html>
<html>

<head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="" />
    <!-- bootstrap-css -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- //bootstrap-css -->
    <!-- Custom CSS -->
    <link href="css/style.css" rel='stylesheet' type='text/css' />
    <link href="css/style-responsive.css" rel="stylesheet" />
    <!-- font CSS -->
    <link
        href='//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic'
        rel='stylesheet' type='text/css'>
    <!-- font-awesome icons -->
    <link rel="stylesheet" href="css/font.css" type="text/css" />
    <link href="css/font-awesome.css" rel="stylesheet">
    <!-- //font-awesome icons -->
    <script src="js/jquery2.0.3.min.js"></script>
</head>

<body>
    <section id="container">
        <!--header start-->
        <header class="header fixed-top clearfix">
            <!--logo start-->
            <div class="brand">
                <a href="index.html" class="logo">
                    DASHBOARD
                </a>
            </div>

            <div class="top-nav clearfix">
                <!--search & user info start-->
                <ul class="nav pull-right top-menu">
                    <li>
                        <input type="text" class="form-control search" placeholder=" Search">
                    </li>
                    <!-- user login dropdown start-->
                    <li class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <img alt="" src="images/2.jpg">
                            <span id="fullname" class="username"></span>
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu extended logout">
                            <li><a href="#"><i class=" fa fa-suitcase"></i>Profile</a></li>
                            <li><a href="#"><i class="fa fa-cog"></i> Settings</a></li>
                            <li><a onclick="logout()"><i class="fa fa-key"></i> Log Out</a></li>
                        </ul>
                    </li>
                    <!-- user login dropdown end -->

                </ul>
                <!--search & user info end-->
            </div>
        </header>
        <!--header end-->
        <!--sidebar start-->
        <aside>
            <div id="sidebar" class="nav-collapse">
                <!-- sidebar menu start-->
                <div class="leftside-navigation">
                    <ul class="sidebar-menu" id="nav-accordion">
                        <li>
                            <a class="active" href="index.html">
                                <i class="fa fa-dashboard"></i>
                                <span>Dashboard</span>
                            </a>
                        </li>
                        <li class="sub-menu">
                            <a href="javascript:;">
                                <i class="fa fa-th"></i>
                                <span>Bộ môn</span>
                            </a>
                            <ul class="sub">
                                <li><a href="showbomon.html">Liệt kê bộ môn</a></li>
                            </ul>
                        </li>
                        <li class="sub-menu">
                            <a href="javascript:;">
                                <i class="fa fa-tasks"></i>
                                <span>Giáo viên</span>
                            </a>
                            <ul class="sub">
                                <li><a href="addgiaovien.html">Thêm giáo viên</a></li>
                                <li><a href="showgiaovien.html">Liệt kê giáo viên</a></li>
                            </ul>
                        </li>
                        <li class="sub-menu">
                            <a href="javascript:;">
                                <i class="fa fa-book"></i>
                                <span>Sinh Viên</span>
                            </a>
                            <ul class="sub">
                                <li><a href="addsinhvien.html">Thêm sinh viên</a></li>
                                <li><a href="showsinhvien.html">Liệt kê sinh viên</a></li>
                            </ul>
                        </li>
                        <li class="sub-menu">
                            <a href="javascript:;">
                                <i class="fa fa-book"></i>
                                <span>Đề tài</span>
                            </a>
                            <ul class="sub">
                                <li><a href="adddetai.html">Thêm đề tài</a></li>
                                <li><a href="showdetai.html">Liệt kê đề tài</a></li>
                            </ul>
                        </li>
                        <li class="sub-menu">
                            <a href="javascript:;">
                                <i class="fa fa-book"></i>
                                <span>Chủ đề</span>
                            </a>
                            <ul class="sub">
                                <li><a href="addchude.html">Thêm chủ đề</a></li>
                                <li><a href="showchude.html">Liệt kê chủ đề</a></li>
                            </ul>
                        </li>
                        <li class="sub-menu">
                            <a href="javascript:;">
                                <i class="fa fa-book"></i>
                                <span>Công nghệ</span>
                            </a>
                            <ul class="sub">
                                <li><a href="addcongnghe.html">Thêm công nghệ</a></li>
                                <li><a href="showcongnghe.html">Liệt kê công nghệ</a></li>
                            </ul>
                        </li>
                        <li class="sub-menu">
                            <a href="javascript:;">
                                <i class="fa fa-book"></i>
                                <span>Ngôn ngữ</span>
                            </a>
                            <ul class="sub">
                                <li><a href="addngonngu.html">Thêm ngôn ngữ</a></li>
                                <li><a href="showngonngu.html">Liệt kê ngôn ngữ</a></li>
                            </ul>
                        </li>
                        <li class="sub-menu">
                            <a href="javascript:;">
                                <i class=" fa fa-bar-chart-o"></i>
                                <span>Tài liệu</span>
                            </a>
                            <ul class="sub">
                                <li><a href="addtailieu.html">Thêm tài liệu</a></li>
                                <li><a href="showtailieu.html">Liệt kê tài liệu</a></li>
                                <li><a href="showtailieu.html">Quản lý tài liệu sinh viên upload</a></li>
                            </ul>
                        </li>
                        <li class="sub-menu">
                            <a href="showcontact.html">
                                <i class=" fa fa-bar-chart-o"></i>
                                <span>Liên hệ</span>
                            </a>
                        </li>
                        <li class="sub-menu">
                            <a href="javascript:;">
                                <i class=" fa fa-bar-chart-o"></i>
                                <span>Blog</span>
                            </a>
                            <ul class="sub">
                                <li><a href="addblog.html">Thêm Blog</a></li>
                                <li><a href="showblog.html">Liệt kê blog</a></li>
                            </ul>
                        </li>
                        <li class="sub-menu">
                            <a href="javascript:;">
                                <i class="fa fa-envelope"></i>
                                <span>Mail </span>
                            </a>
                            <ul class="sub">
                                <li><a href="showemail.html">Quản lý Email</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="login.html">
                                <i class="fa fa-user"></i>
                                <span>Login Page</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- sidebar menu end-->
            </div>
        </aside>

        <!--sidebar end-->
        <!--main content start-->
        <section id="main-content">
            <section class="wrapper">
                <div class="table-agile-info">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            TÀI LIỆU
                        </div>
                        <div class="table-responsive">
                            <table class="table table-striped b-t b-light">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>Tên đề tài</th>
                                        <th>MSSV</th>
                                        <th>Họ tên</th>
                                        <th>MSGV</th>
                                        <th>Họ tên</th>
                                        <th>File đính kèm</th>
                                        <th>Mô tả</th>
                                        <th>Tóm tắt</th>
                                        <th>Vị trí</th>
                                        <th>Bộ môn ID</th>
                                        <th>Bộ môn Tên</th>
                                        <th>Chủ đề</th>
                                        <th>Ngôn ngữ</th>
                                        <th>Công nghệ</th>
                                        <th style="width:30px;"></th>
                                    </tr>
                                </thead>
                                <tbody id="list-tailieu">

                                </tbody>
                            </table>
                        </div>
                        <div class="modal fade" id="updateLuanVan" tabindex="-1" role="dialog"
                            aria-labelledby="myModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal"
                                            aria-hidden="true">&times;</button>
                                        <h4 class="modal-title">Cập nhật công nghệ</h4>
                                    </div>
                                    
                                    <div class="modal-body">
                                        <div class="form-group">
                                            <label for="tuaDe">Tên đề tài</label>
                                            <input type="text" name="tuaDe" class="form-control" id="tuaDe">
                                        </div>
                                        <div class="form-group">
                                            <label for="mssv">MSSV</label>
                                            <input type="text" name="mssv" class="form-control" id="mssv">
                                        </div>
                                        <div class="form-group">
                                            <label for="msgv">MSGV</label>
                                            <input type="text" name="msgv" class="form-control" id="msgv">
                                        </div>
                                        <div class="form-group">
                                            <label for="file">File đính kèm</label>
                                            <input type="file" name="file" class="form-control" id="file">
                                        </div>
                                        <div class="form-group">
                                            <label for="moTa">Mô tả</label>
                                            <input type="text" name="moTa" class="form-control" id="moTa">
                                        </div>
                                        <div class="form-group">
                                            <label for="tomTat">Tóm tắt</label>
                                            <input type="text" name="tomTat" class="form-control" id="tomTat">
                                        </div>
                                        <div class="form-group">
                                            <label for="viTri">Vị trí</label>
                                            <input type="text" name="viTri" class="form-control" id="viTri">
                                        </div>
                                        <div class="form-group">
                                            <label for="bomon_id">Bộ Môn</label>
                                            <select class="form-control m-bot15" id="bomon_id" name="bomon_id">

                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Chọn chủ đề</label><br>
                                            <div id="chude_id" name="chude_id">

                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Chọn Ngôn ngữ</label><br>
                                            <div id="ngonngu_id" name="ngonngu_id">

                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">Chọn Công nghệ</label><br>
                                            <div id="congnghe_id" name="congnghe_id">

                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-default"
                                                data-dismiss="modal">Close</button>
                                            <button type="submit" class="btn btn-primary" id="update-luanvan">Save
                                                changes</button>
                                        </div>
                                    </div>

                                </div><!-- /.modal-content -->
                            </div><!-- /.modal-dialog -->
                        </div>
                    </div>
                </div>
            </section>

        </section>

        <!--main content end-->
    </section>
    <script src="js/interceptors.js"></script>
    <script src="js/tailieu.js"></script>
    <script src="js/bootstrap.js"></script>
    <script src="js/jquery.dcjqaccordion.2.7.js"></script>
    <script src="js/scripts.js"></script>
    <!-- <script src="js/jquery.slimscroll.js"></script>
    <script src="js/jquery.nicescroll.js"></script>
    <script src="js/jquery.scrollTo.js"></script> -->
    <script>
        function handleLuanVan(id){
    var luanVanItem = document.querySelector(".luanvan-"+id);
    var gettuaDe = luanVanItem.querySelector(".tuaDe").innerText;
    var getmssv = luanVanItem.querySelector(".mssv").innerText;
    var getmsgv = luanVanItem.querySelector(".msgv").innerText;
    var getfile = luanVanItem.querySelector(".file").innerText;
    var getmoTa = luanVanItem.querySelector(".moTa").innerText;
    var gettomTat = luanVanItem.querySelector(".tomTat").innerText;
    var getviTri = luanVanItem.querySelector(".viTri").innerText;
    var getbomon_id = luanVanItem.querySelector(".bomon_id").innerText;
    var getchude_id = luanVanItem.querySelector(".chude_id").innerText;
    var getngonngu_id = luanVanItem.querySelector(".ngonngu_id").innerText;
    var getcongnghe_id = luanVanItem.querySelector(".congnghe_id").innerText;


    var tuaDe = document.querySelector('input[name="tuaDe"]');
    var mssv = document.querySelector('input[name="mssv"]');
    var msgv = document.querySelector('input[name="msgv"]');
    var file = document.querySelector('input[name="file"]');
    var tomTat = document.querySelector('input[name="tomTat"]');
    var moTa = document.querySelector('input[name="moTa"]');
    var viTri = document.querySelector('input[name="viTri"]');
    var bomon_id = document.querySelector('select[name="bomon_id"]');
    var chude_id = $.map($('input[name="chude_id"]:checked'), function (chude_id) { return chude_id.value; });
    var ngonngu_id = $.map($('input[name="ngonngu_id"]:checked'), function (ngonngu_id) { return ngonngu_id.value; });
    var congnghe_id = $.map($('input[name="congnghe_id"]:checked'), function (congnghe_id) { return congnghe_id.value; });

    tuaDe.value = gettuaDe;
    mssv.value = getmssv;
    msgv.value = getmsgv;
    file.files[0] = getfile;
    tomTat.value = gettomTat;
    moTa.value = getmoTa;
    viTri.value = getviTri;
    bomon_id.value = getbomon_id;
    chude_id = getchude_id;
    ngonngu_id = getngonngu_id;
    congnghe_id = getcongnghe_id;
    
    console.log(gettuaDe);
    console.log(getmssv);
    console.log(getmsgv);
    console.log(getfile);
    console.log(getmoTa);
    console.log(gettomTat);
    console.log(getviTri);
    console.log(getbomon_id);
    console.log(getchude_id);
    console.log(getngonngu_id);
    console.log(getcongnghe_id);

    var btnUpdateLV = document.querySelector('#update-luanvan');
    btnUpdateLV.onclick = function(){
        var formdata = new FormData();
            formdata.append('file', $('#file').get(0).files[0]);
            var luanvan = {
                tuaDe: $('#tuaDe').val(),
                moTa: $('#moTa').val(),
                tomTat: $('#tomTat').val(),
                viTri: $('#viTri').val(),
                mssv: $('#mssv').val(),
                msgv: $('#msgv').val(),
                bomon_id: $('#bomon_id').val(),
                chude_id: $.map($('input[name="chude_id"]:checked'), function (chude_id) { return chude_id.value; }),
                ngonngu_id: $.map($('input[name="ngonngu_id"]:checked'), function (ngonngu_id) { return ngonngu_id.value; }),
                congnghe_id: $.map($('input[name="congnghe_id"]:checked'), function (congnghe_id) { return congnghe_id.value; }),
            }
            data = JSON.stringify(luanvan);
            formdata.append('luanvan', data);
            console.log(data);
            var requestOptions = {
                method: 'PUT',
                body: formdata,
                redirect: 'follow'
            };
            fetch('http://127.0.0.1:8120/api/luanvan/' + id, requestOptions)
                .then(response => response.text())
                .then(function (response){
                    alert("Cập nhật thành công");
                    // window.location.reload();
                })
                .catch(function (error){
                    alert("Cập nhật thất bại");
                    // window.location.reload();
                });
    }

}
    </script>
</body>

</html>